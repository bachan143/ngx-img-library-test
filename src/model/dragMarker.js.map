{"version":3,"sources":["../../../src/model/dragMarker.ts"],"names":[],"mappings":"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","file":"dragMarker.js","sourceRoot":"","sourcesContent":["import { Handle } from \"./handle\";\nimport { PointPool } from \"./pointPool\";\nimport { Point } from \"./point\";\nimport { CropperSettings } from \"../cropperSettings\";\nimport { Bounds } from \"./bounds\";\n\nexport class DragMarker extends Handle {\n  private iconPoints: Array<Point>;\n  private scaledIconPoints: Array<Point>;\n\n  constructor(\n    x: number,\n    y: number,\n    radius: number,\n    cropperSettings: CropperSettings\n  ) {\n    super(x, y, radius, cropperSettings);\n    this.iconPoints = [];\n    this.scaledIconPoints = [];\n    this.getDragIconPoints(this.iconPoints, 1);\n    this.getDragIconPoints(this.scaledIconPoints, 1.2);\n  }\n\n  public draw(ctx: CanvasRenderingContext2D) {\n    if (this.over || this.drag) {\n      this.drawIcon(ctx, this.scaledIconPoints);\n    } else {\n      this.drawIcon(ctx, this.iconPoints);\n    }\n  }\n\n  public getDragIconPoints(arr: Array<any>, scale: number) {\n    let maxLength = 17 * scale;\n    let arrowWidth = 14 * scale;\n    let arrowLength = 8 * scale;\n    let connectorThroat = 4 * scale;\n\n    arr.push(\n      PointPool.instance.borrow(-connectorThroat / 2, maxLength - arrowLength)\n    );\n    arr.push(\n      PointPool.instance.borrow(-arrowWidth / 2, maxLength - arrowLength)\n    );\n    arr.push(PointPool.instance.borrow(0, maxLength));\n    arr.push(\n      PointPool.instance.borrow(arrowWidth / 2, maxLength - arrowLength)\n    );\n    arr.push(\n      PointPool.instance.borrow(connectorThroat / 2, maxLength - arrowLength)\n    );\n    arr.push(\n      PointPool.instance.borrow(connectorThroat / 2, connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(maxLength - arrowLength, connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(maxLength - arrowLength, arrowWidth / 2)\n    );\n    arr.push(PointPool.instance.borrow(maxLength, 0));\n    arr.push(\n      PointPool.instance.borrow(maxLength - arrowLength, -arrowWidth / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(maxLength - arrowLength, -connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(connectorThroat / 2, -connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(connectorThroat / 2, -maxLength + arrowLength)\n    );\n    arr.push(\n      PointPool.instance.borrow(arrowWidth / 2, -maxLength + arrowLength)\n    );\n    arr.push(PointPool.instance.borrow(0, -maxLength));\n    arr.push(\n      PointPool.instance.borrow(-arrowWidth / 2, -maxLength + arrowLength)\n    );\n    arr.push(\n      PointPool.instance.borrow(-connectorThroat / 2, -maxLength + arrowLength)\n    );\n    arr.push(\n      PointPool.instance.borrow(-connectorThroat / 2, -connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(-maxLength + arrowLength, -connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(-maxLength + arrowLength, -arrowWidth / 2)\n    );\n    arr.push(PointPool.instance.borrow(-maxLength, 0));\n    arr.push(\n      PointPool.instance.borrow(-maxLength + arrowLength, arrowWidth / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(-maxLength + arrowLength, connectorThroat / 2)\n    );\n    arr.push(\n      PointPool.instance.borrow(-connectorThroat / 2, connectorThroat / 2)\n    );\n  }\n\n  public drawIcon(ctx: CanvasRenderingContext2D, points: Array<Point>) {\n    if (this.cropperSettings.showCenterMarker) {\n      ctx.beginPath();\n      ctx.moveTo(points[0].x + this.position.x, points[0].y + this.position.y);\n      for (let k = 0; k < points.length; k++) {\n        let p = points[k];\n        ctx.lineTo(p.x + this.position.x, p.y + this.position.y);\n      }\n      ctx.closePath();\n      ctx.fillStyle = this.cropperSettings.cropperDrawSettings.dragIconFillColor;\n      ctx.fill();\n      ctx.lineWidth = this.cropperSettings.cropperDrawSettings.dragIconStrokeWidth;\n      ctx.strokeStyle = this.cropperSettings.cropperDrawSettings.dragIconStrokeColor;\n      ctx.stroke();\n    }\n  }\n\n  public recalculatePosition(bounds: Bounds) {\n    let c = bounds.getCentre();\n    this.setPosition(c.x, c.y);\n    PointPool.instance.returnPoint(c);\n  }\n}\n"]}